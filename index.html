<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>GymStart Beta V0.3</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>

    <!-- Background Elements -->
    <div class="bg-orb orb-1"></div>
    <div class="bg-orb orb-2"></div>
    <div class="glass-overlay"></div>

    <!-- Admin Modal -->
    <div id="admin-modal" class="modal-wrapper">
        <div class="glass-modal">
            <div class="modal-header">
                <h3>⚙️ הגדרות מאמן</h3>
                <button class="icon-btn" onclick="app.closeAdmin()">✕</button>
            </div>
            
            <div class="admin-controls">
                <select id="admin-prog-select" class="glass-input" onchange="app.renderAdminList()">
                    <option value="A">תוכנית A (רגליים/גב)</option>
                    <option value="B">תוכנית B (חזה/כתפיים)</option>
                    <option value="FBW">תוכנית FBW</option>
                </select>
            </div>

            <div id="admin-list" class="admin-list-container"></div>
            
            <div class="modal-footer">
                <button class="btn-text" onclick="app.openBank()">+ הוסף תרגיל מהבנק</button>
                <button class="btn-primary" onclick="app.saveAdmin()">שמור שינויים</button>
            </div>
        </div>
    </div>

    <!-- Bank Modal -->
    <div id="bank-modal" class="modal-wrapper" style="z-index: 110;">
        <div class="glass-modal">
            <div class="modal-header">
                <h3>📚 בנק תרגילים</h3>
                <button class="icon-btn" onclick="app.closeBank()">✕</button>
            </div>
            <div class="bank-filters">
                <input type="text" id="bank-search" class="glass-input" placeholder="חפש תרגיל..." onkeyup="app.filterBank()">
                <div class="category-tags" id="bank-cats"></div>
            </div>
            <div id="bank-list" class="admin-list-container"></div>
        </div>
    </div>

    <!-- History Detail Modal -->
    <div id="history-modal" class="modal-wrapper">
        <div class="glass-modal">
            <div class="modal-header">
                <h3 id="hist-modal-title">פרטי אימון</h3>
                <button class="icon-btn" onclick="app.closeHistoryModal()">✕</button>
            </div>
            <div id="hist-detail-content" class="admin-list-container"></div>
            <div style="display: flex; gap:10px;">
                <button class="btn-glass" onclick="app.copySingleHistory()" style="flex:1">📋 העתק סיכום</button>
                <button class="btn-danger-text" onclick="app.deleteCurrentLog()" style="flex:1">🗑 מחק</button>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container">
        
        <!-- Navbar -->
        <header class="navbar">
            <div class="nav-left">
                <!-- Global Timer Removed from here -->
                <div class="logo-small">GYM<span>START</span></div>
            </div>
            <button id="nav-back" class="icon-btn" onclick="app.goBack()" style="visibility: hidden;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
            </button>
        </header>

        <!-- SCREENS -->

        <!-- 1. HOME -->
        <div id="screen-home" class="screen active">
            <div class="hero">
                <h1 id="greeting">היי, ברוכה הבאה</h1>
                <p>מוכנה לזוז?</p>
            </div>

            <div class="glass-card status-card">
                <div class="icon-circle">📅</div>
                <div>
                    <div class="label">אימון אחרון</div>
                    <div id="last-workout-display" class="value">טוען...</div>
                </div>
            </div>

            <!-- Spacer Removed - Buttons moved up -->
            <div style="margin-top: 20px;"></div>

            <button class="btn-primary big-btn" onclick="app.nav('screen-program-select')">
                <div class="icon">▶</div>
                <span>התחילי אימון</span>
            </button>

            <button class="btn-glass" onclick="app.showHistory()">
                <span>📜 היסטוריה וגיבוי</span>
            </button>

            <div class="spacer"></div>
            <div class="version-tag">Beta V0.3</div>
        </div>

        <!-- 1.5 PROGRAM SELECT -->
        <div id="screen-program-select" class="screen">
            <h2 class="page-title">בחרי אימון להיום</h2>
            <div class="program-grid">
                <button class="glass-card prog-card" onclick="app.selectProgram('A')">
                    <div class="prog-icon">🦵</div>
                    <div class="prog-name">A: רגליים וגב</div>
                    <div class="prog-desc">סקוואט, RDL, פולי, בטן</div>
                </button>
                <button class="glass-card prog-card" onclick="app.selectProgram('B')">
                    <div class="prog-icon">💪</div>
                    <div class="prog-name">B: חזה, כתפיים וידיים</div>
                    <div class="prog-desc">לחיצות, ידיים, פלאנק צד</div>
                </button>
                <button class="glass-card prog-card" onclick="app.selectProgram('FBW')">
                    <div class="prog-icon">🔥</div>
                    <div class="prog-name">FBW: כל הגוף</div>
                    <div class="prog-desc">הכל מהכל - יעיל ומהיר</div>
                </button>
            </div>
        </div>

        <!-- 2. OVERVIEW -->
        <div id="screen-overview" class="screen">
            <h2 class="page-title" id="overview-title">סקירת אימון</h2>
            <div id="overview-list" class="list-stack"></div>
            
            <div class="bottom-bar">
                <button class="btn-primary" onclick="app.startWorkout()">מתחילים! 🚀</button>
            </div>
        </div>

        <!-- 3. ACTIVE EXERCISE -->
        <div id="screen-active" class="screen">
            
            <div class="ex-header">
                <div id="set-badge" class="badge">סט 1</div>
                <h2 id="ex-name">שם התרגיל</h2>
                <div id="coach-note" class="note-pill"></div>
            </div>

            <div id="history-badge" class="history-pill">--</div>

            <!-- DYNAMIC INPUT AREA -->
            <div id="input-area">
                
                <!-- NEW: Steppers (Replaces Scrollers) -->
                <div id="stepper-container" class="stepper-wrapper">
                    <!-- Weight Stepper -->
                    <div class="stepper-row">
                        <label>משקל (<span id="unit-label-step">ק״ג</span>)</label>
                        <div class="stepper-ctrl">
                            <button class="step-btn" onclick="app.adjustWeight(-1)">−</button>
                            <div class="step-val" id="val-weight">10</div>
                            <button class="step-btn" onclick="app.adjustWeight(1)">+</button>
                        </div>
                    </div>
                    <!-- Reps Stepper -->
                    <div class="stepper-row">
                        <label>חזרות</label>
                        <div class="stepper-ctrl">
                            <button class="step-btn" onclick="app.adjustReps(-1)">−</button>
                            <div class="step-val" id="val-reps">12</div>
                            <button class="step-btn" onclick="app.adjustReps(1)">+</button>
                        </div>
                    </div>
                </div>

                <!-- Stopwatch UI (For Plank) -->
                <div id="stopwatch-container" class="stopwatch-ui" style="display: none;">
                    <div class="time-display" id="sw-display">00:00</div>
                    <button id="btn-sw-toggle" class="btn-circle-play" onclick="app.toggleStopwatch()">▶</button>
                    <div class="sw-hint">לחצי למדידת זמן ביצוע</div>
                </div>
            </div>

            <!-- Feeling Selector -->
            <div class="feeling-section" id="feeling-section">
                <div class="feeling-row">
                    <button class="feel-btn easy" onclick="app.selectFeel('easy')">😌</button>
                    <button class="feel-btn good selected" onclick="app.selectFeel('good')">🙂</button>
                    <button class="feel-btn hard" onclick="app.selectFeel('hard')">🥵</button>
                </div>
                <div class="feel-label" id="feel-text">בוינג (טוב)</div>
            </div>

            <!-- NEW: REST TIMER (Center Screen) -->
            <div id="rest-timer-area" class="rest-timer-box" style="display: none;">
                <div class="rest-label">מנוחה</div>
                <div id="rest-timer-val">00:00</div>
            </div>

            <div class="spacer"></div>

            <!-- Action Area -->
            <div id="action-area">
                <button id="btn-finish" class="btn-primary" onclick="app.finishSet()">
                    <span>סיום סט</span>
                </button>

                <!-- Decision Buttons (After Set 3) -->
                <div id="decision-buttons" style="display:none; gap:10px;">
                    <button class="btn-glass" onclick="app.addSet()">➕ עוד סט</button>
                    <button class="btn-primary" onclick="app.nextExercise()">✅ תרגיל הבא</button>
                </div>
            </div>

            <div class="sub-actions">
                <button class="link-btn" onclick="app.deleteLastSet()">בטל סט אחרון</button>
                <button class="link-btn" onclick="app.skipExercise()">דלג תרגיל</button>
            </div>
        </div>

        <!-- 4. SUMMARY -->
        <div id="screen-summary" class="screen">
            <div class="hero">
                <h1>כל הכבוד! 🎉</h1>
                <p>האימון הושלם בהצלחה</p>
                <div id="summary-meta" class="summary-meta"></div>
            </div>
            <div id="summary-text" class="glass-card summary-box"></div>
            
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <button class="btn-glass" onclick="app.copySummaryToClipboard()">📋 העתק למאמן</button>
                <button class="btn-primary" onclick="app.saveAndHome()">שמור וסיים</button>
            </div>
        </div>

        <!-- 5. HISTORY -->
        <div id="screen-history" class="screen">
            <h2 class="page-title">היסטוריה</h2>
            <div class="history-actions">
                 <button class="btn-small" onclick="app.exportData()">⬇️ גיבוי</button>
                 <label class="btn-small">
                     ⬆️ שחזור <input type="file" hidden onchange="app.importData(this)">
                 </label>
                 <button class="btn-small" style="color: var(--primary); border: 1px solid var(--primary);" onclick="app.copySelectedHistory()">📋 העתק נבחרים</button>
            </div>
            <div id="history-list" class="list-stack"></div>
            <div class="spacer"></div>
            <button class="btn-glass" onclick="app.openAdmin()">⚙️ כניסת מאמן</button>
        </div>

    </div>

    <script src="script.js"></script>
</body>
</html>
