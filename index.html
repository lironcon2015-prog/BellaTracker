<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>GymStart Pro</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>

    <!-- Professional Background: Deep Atmosphere instead of Orbs -->
    <div class="bg-atmosphere"></div>

    <!-- Admin Modal -->
    <div id="admin-modal" class="modal-wrapper">
        <div class="glass-modal">
            <div class="modal-header">
                <h3>ניהול תוכנית</h3>
                <button class="icon-btn-plain" onclick="app.closeAdmin()">סגור</button>
            </div>
            
            <div class="admin-controls">
                <div class="input-group">
                    <label>תוכנית עריכה</label>
                    <select id="admin-prog-select" class="native-select" onchange="app.renderAdminList()">
                        <option value="A">תוכנית A</option>
                        <option value="B">תוכנית B</option>
                        <option value="FBW">תוכנית FBW</option>
                    </select>
                </div>
            </div>

            <div id="admin-list" class="ios-list"></div>
            
            <div class="modal-footer">
                <button class="btn-action-row" onclick="app.openBank()">
                    <span>הוסף תרגיל</span>
                    <span class="plus-icon">+</span>
                </button>
                <button class="btn-primary" onclick="app.saveAdmin()">שמור שינויים</button>
            </div>
        </div>
    </div>

    <!-- Bank Modal -->
    <div id="bank-modal" class="modal-wrapper" style="z-index: 110;">
        <div class="glass-modal">
            <div class="modal-header">
                <h3>בנק תרגילים</h3>
                <button class="icon-btn-plain" onclick="app.closeBank()">סגור</button>
            </div>
            <div class="bank-filters">
                <input type="text" id="bank-search" class="search-input" placeholder="חפש..." onkeyup="app.filterBank()">
                <div class="category-tags" id="bank-cats"></div>
            </div>
            <div id="bank-list" class="ios-list"></div>
        </div>
    </div>

    <!-- History Detail Modal -->
    <div id="history-modal" class="modal-wrapper">
        <div class="glass-modal">
            <div class="modal-header">
                <h3>פרטי אימון</h3>
                <button class="icon-btn-plain" onclick="app.closeHistoryModal()">סגור</button>
            </div>
            <div id="hist-meta-header" class="history-meta-box"></div>
            
            <div id="hist-detail-content" class="ios-list" style="margin-bottom: 20px;"></div>
            
            <div class="actions-grid">
                <button class="btn-secondary" onclick="app.copySingleHistory()">העתק סיכום</button>
                <button class="btn-destructive" onclick="app.deleteCurrentLog()">מחק רישום</button>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container">
        
        <!-- Navbar -->
        <header class="navbar">
            <div class="nav-left">
                <div class="logo-text">GymStart</div>
            </div>
            <button id="nav-back" class="icon-btn-plain" onclick="app.goBack()" style="visibility: hidden;">
                חזור
            </button>
        </header>

        <!-- SCREENS -->

        <!-- 1. HOME -->
        <div id="screen-home" class="screen active">
            <div class="home-header">
                <h1 id="greeting">דף הבית</h1>
                <p>סקירת פעילות</p>
            </div>

            <div class="glass-card compact-card">
                <div class="row-spread">
                    <span class="label-dim">אימון אחרון</span>
                    <span id="last-workout-display" class="value-highlight">--</span>
                </div>
            </div>

            <div class="spacer"></div>

            <div class="main-actions">
                <button class="btn-primary big-btn" onclick="app.nav('screen-program-select')">
                    התחל אימון חדש
                </button>

                <button class="btn-secondary" onclick="app.showHistory()">
                    היסטוריה וגיבוי
                </button>
            </div>
            
            <div class="version-tag">Pro V0.8</div>
        </div>

        <!-- 1.5 PROGRAM SELECT -->
        <div id="screen-program-select" class="screen">
            <h2 class="page-title">בחירת תוכנית</h2>
            <div class="ios-list menu-list">
                <div class="list-row-clickable" onclick="app.selectProgram('A')">
                    <div class="row-content">
                        <span class="row-title">תוכנית A</span>
                        <span class="row-subtitle">רגליים, גב</span>
                    </div>
                    <div class="row-arrow">›</div>
                </div>
                <div class="list-row-clickable" onclick="app.selectProgram('B')">
                    <div class="row-content">
                        <span class="row-title">תוכנית B</span>
                        <span class="row-subtitle">חזה, כתפיים, ידיים</span>
                    </div>
                    <div class="row-arrow">›</div>
                </div>
                <div class="list-row-clickable" onclick="app.selectProgram('FBW')">
                    <div class="row-content">
                        <span class="row-title">תוכנית FBW</span>
                        <span class="row-subtitle">אימון כל הגוף</span>
                    </div>
                    <div class="row-arrow">›</div>
                </div>
            </div>
        </div>

        <!-- 2. OVERVIEW -->
        <div id="screen-overview" class="screen">
            <h2 class="page-title" id="overview-title">סקירה</h2>
            <div id="overview-list" class="ios-list"></div>
            
            <div class="bottom-bar">
                <button class="btn-primary" onclick="app.startWorkout()">התחל אימון</button>
            </div>
        </div>

        <!-- 3. ACTIVE EXERCISE -->
        <div id="screen-active" class="screen">
            
            <div class="active-header">
                <div id="set-badge" class="capsule-badge">סט 1</div>
                <h2 id="ex-name">שם התרגיל</h2>
                <div id="coach-note" class="note-text"></div>
            </div>

            <div id="history-badge" class="history-text">--</div>

            <div class="workspace">
                <!-- INPUTS -->
                <div id="cards-container" class="inputs-row">
                    <div class="data-input-wrapper">
                        <select id="select-weight" class="minimal-select"></select>
                        <span class="input-label" id="unit-label-card">ק״ג</span>
                    </div>
                    <div class="divider-vertical"></div>
                    <div class="data-input-wrapper">
                        <select id="select-reps" class="minimal-select"></select>
                        <span class="input-label">חזרות</span>
                    </div>
                </div>

                <!-- STOPWATCH (Professional) -->
                <div id="stopwatch-container" class="stopwatch-wrapper" style="display: none;">
                    <div class="stopwatch-digits" id="sw-display">00:00</div>
                    <button id="btn-sw-toggle" class="btn-play-pause" onclick="app.toggleStopwatch()">
                        <svg class="play-icon" viewBox="0 0 24 24"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>
                        <svg class="stop-icon" viewBox="0 0 24 24" style="display:none"><path fill="currentColor" d="M6 6h12v12H6z"/></svg>
                    </button>
                    <div class="sw-hint">מדידת זמן</div>
                </div>
            </div>

            <!-- FEELING -->
            <div class="feeling-container">
                <div class="segment-control">
                    <button class="segment-btn easy" onclick="app.selectFeel('easy')">קל</button>
                    <button class="segment-btn good selected" onclick="app.selectFeel('good')">בינוני</button>
                    <button class="segment-btn hard" onclick="app.selectFeel('hard')">קשה</button>
                </div>
            </div>

            <!-- REST TIMER -->
            <div id="rest-timer-area" class="rest-overlay" style="display: none;">
                <div class="circular-timer-minimal">
                    <svg viewBox="0 0 100 100">
                        <circle class="bg-ring" cx="50" cy="50" r="45"></circle>
                        <circle id="rest-ring-prog" class="prog-ring" cx="50" cy="50" r="45"></circle>
                    </svg>
                    <div class="timer-text-minimal" id="rest-timer-val">00:00</div>
                </div>
                <div class="rest-label">מנוחה</div>
            </div>

            <div class="spacer"></div>

            <div id="action-area" class="action-dock">
                <button id="btn-finish" class="btn-primary" onclick="app.finishSet()">
                    סיום סט
                </button>

                <div id="decision-buttons" style="display:none; width:100%; gap:12px;">
                    <button class="btn-secondary" onclick="app.addSet()" style="flex:1">הוסף סט</button>
                    <button class="btn-primary" onclick="app.nextExercise()" style="flex:1">הבא</button>
                </div>
            </div>

            <div class="sub-actions-row">
                <button class="text-link" onclick="app.deleteLastSet()">ביטול סט</button>
                <button class="text-link" onclick="app.skipExercise()">דילוג</button>
            </div>
        </div>

        <!-- 4. SUMMARY -->
        <div id="screen-summary" class="screen">
            <div class="summary-hero">
                <h1>אימון הושלם</h1>
                <div id="summary-meta" class="summary-meta-tag"></div>
            </div>
            <div id="summary-text" class="summary-content"></div>
            
            <div class="actions-grid">
                <button class="btn-secondary" onclick="app.copySummaryToClipboard()">העתק</button>
                <button class="btn-primary" onclick="app.saveAndHome()">סיום</button>
            </div>
        </div>

        <!-- 5. HISTORY -->
        <div id="screen-history" class="screen">
            <div class="header-row">
                <h2 class="page-title">היסטוריה</h2>
                <div class="header-actions">
                     <button class="btn-small-text" onclick="app.exportData()">גיבוי</button>
                     <label class="btn-small-text">
                         שחזור <input type="file" hidden onchange="app.importData(this)">
                     </label>
                </div>
            </div>
            
            <!-- Bulk Actions Toolbar -->
            <div class="toolbar">
                 <button class="btn-toolbar" onclick="app.selectAllHistory()">בחר הכל</button>
                 <div style="display:flex; gap:15px;">
                    <button class="btn-toolbar" onclick="app.copySelectedHistory()">העתק</button>
                    <button id="btn-del-selected" class="btn-toolbar danger" onclick="app.deleteSelectedHistory()" disabled>מחק</button>
                 </div>
            </div>

            <div id="history-list" class="ios-list history-stream"></div>
            
            <div class="spacer"></div>
            <button class="btn-secondary" onclick="app.openAdmin()">ממשק מאמן</button>
        </div>

    </div>

    <script src="script.js"></script>
</body>
</html>
