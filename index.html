<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>התוכנית שלי</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700;900&display=swap" rel="stylesheet">
</head>
<body>
    <div class="background-overlay"></div>

    <!-- ADMIN MODAL -->
    <div id="admin-modal" class="modal-overlay">
        <div class="modal-content large">
            <h3>🛠️ עריכת תוכנית (מאמן)</h3>
            <div id="admin-routine-list" class="vertical-stack"></div>
            <button class="btn-text" onclick="addNewExerciseToRoutine()">+ הוסף תרגיל מהמאגר</button>
            <div style="margin-top: 20px; display: flex; gap: 10px;">
                <button class="btn-main primary-gradient" onclick="saveAdminChanges()">שמור שינויים</button>
                <button class="btn-text" onclick="closeAdmin()">ביטול</button>
            </div>
        </div>
    </div>

    <!-- EDIT EXERCISE MODAL (ADMIN) -->
    <div id="edit-ex-modal" class="modal-overlay" style="z-index: 2000;">
        <div class="modal-content">
            <h3>עריכת תרגיל</h3>
            <div class="input-group">
                <label>שם התרגיל</label>
                <input type="text" id="admin-edit-name" class="minimal-input">
            </div>
            <div class="input-group">
                <label>סוג יחידות</label>
                <select id="admin-edit-unit" class="minimal-select">
                    <option value="kg">משקל (ק״ג)</option>
                    <option value="plates">פלטות (מכונה)</option>
                    <option value="bodyweight">משקל גוף (ללא)</option>
                </select>
            </div>
            <div class="input-group">
                <label>הערת מאמן (תוצג באימון)</label>
                <textarea id="admin-edit-note" class="minimal-input" rows="3"></textarea>
            </div>
            <button class="btn-main primary-gradient" onclick="applyExerciseEdit()">אישור</button>
            <button class="btn-text" onclick="closeEditExModal()">ביטול</button>
        </div>
    </div>

    <!-- APP CONTAINER -->
    <div class="app-container">
        
        <!-- HEADER -->
        <header class="app-header">
            <button id="nav-back" class="back-btn" onclick="goBack()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
            </button>
            <div class="brand-logo">GYM<span>START</span></div>
            <div style="width: 24px;"></div> <!-- Spacer -->
        </header>

        <main class="content-area">

            <!-- HOME SCREEN -->
            <div id="ui-home" class="screen active">
                <div class="hero-section">
                    <h1 id="greeting-title">היי, ברוכה הבאה!</h1>
                    <span>מוכנה לזוז?</span>
                </div>

                <div class="status-card">
                    <div class="status-icon">📅</div>
                    <div class="status-text">
                        <div class="label">אימון אחרון</div>
                        <div id="last-workout-date" class="value">טרם בוצע</div>
                    </div>
                </div>

                <button class="start-btn primary-gradient pulse" onclick="startFlow()">
                    <div class="icon">▶️</div>
                    <div>התחילי אימון</div>
                </button>

                <button class="action-card secondary" onclick="navigate('ui-history')">
                    <div class="card-icon">📜</div>
                    <div class="card-text">היסטוריית אימונים</div>
                </button>
            </div>

            <!-- OVERVIEW SCREEN -->
            <div id="ui-overview" class="screen">
                <h2 class="section-title">האימון להיום</h2>
                
                <div id="general-note-area" class="note-card" style="display:none;">
                    <div class="note-icon">📝</div>
                    <div id="general-note-text"></div>
                </div>

                <div id="overview-list" class="vertical-stack"></div>

                <button class="btn-main primary-gradient" style="margin-top: 20px;" onclick="startActualWorkout()">
                    מתחילים! 🚀
                </button>
            </div>

            <!-- ACTIVE WORKOUT SCREEN -->
            <div id="ui-active" class="screen">
                <div class="exercise-header">
                    <h2 id="active-ex-name">שם התרגיל</h2>
                    <div id="active-coach-note" class="coach-note-banner" style="display:none;"></div>
                </div>

                <!-- History Badge -->
                <div id="history-badge" class="history-pill">
                    אימון שעבר: 10 ק״ג | 12 חזרות
                </div>

                <!-- Sets Container -->
                <div id="sets-container" class="sets-wrapper"></div>

                <!-- Add Set Button -->
                <button class="btn-text dashed" onclick="addSet()">+ הוסף סט נוסף</button>

                <!-- Navigation -->
                <div class="nav-controls">
                    <button class="nav-btn next primary-gradient" onclick="nextExercise()">
                        התרגיל הבא ⬅️
                    </button>
                </div>
            </div>

            <!-- SUMMARY SCREEN -->
            <div id="ui-summary" class="screen">
                <div class="hero-section">
                    <h1>כל הכבוד! 🎉</h1>
                    <span>סיימת עוד אימון בהצלחה</span>
                </div>
                
                <div id="summary-content" class="summary-card"></div>
                
                <button class="btn-main primary-gradient" onclick="finishAndSave()">שמור וסיים</button>
            </div>

            <!-- HISTORY SCREEN -->
            <div id="ui-history" class="screen">
                <h2 class="section-title">היסטוריה</h2>
                <div id="history-list" class="vertical-stack"></div>
                
                <!-- Admin Trigger (Hidden-ish) -->
                <div style="margin-top: 50px; display: flex; justify-content: center;">
                    <button class="admin-trigger" onclick="openAdmin()">⚙️ הגדרות תוכנית</button>
                </div>
            </div>

        </main>
    </div>

    <!-- TEMPLATES -->
    <template id="set-row-template">
        <div class="set-row">
            <div class="set-num">1</div>
            
            <div class="input-wrap weight-wrap">
                <label class="unit-label">ק״ג</label>
                <select class="set-input weight-select"></select>
            </div>

            <div class="input-wrap reps-wrap">
                <label>חזרות/זמן</label>
                <select class="set-input reps-select"></select>
            </div>

            <div class="feeling-selector">
                <button class="feel-btn easy" onclick="rateSet(this, 'easy')">😌</button>
                <button class="feel-btn good" onclick="rateSet(this, 'good')">🙂</button>
                <button class="feel-btn hard" onclick="rateSet(this, 'hard')">🥵</button>
            </div>

            <button class="btn-delete-set" onclick="removeSet(this)">✖</button>
        </div>
    </template>

    <script src="script.js"></script>
</body>
</html>
